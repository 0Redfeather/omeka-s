<?php
$translate = $this->plugin('translate');
$escape = $this->plugin('escapeHtml');
$this->headScript()->appendFile($this->assetUrl('js/item-manage-item-sets.js', 'Omeka'));
$itemSets = [];
foreach ($item->itemSets() as $itemSet) {
  $owner = $itemSet->owner();
  $itemSets[] = [
    'id' => $itemSet->id(),
    'title' => $itemSet->title(),
    'email' => $owner ? $owner->email() : null,
  ];
}
$itemSetTemplate = '
<tr class="item-set-row">
    <td class="item-set-title"></td>
    <td class="item-set-owner-email">__owner-email__</td>
    <td><ul class="actions">
        <li>' . $this->hyperlink('', '#', [
            'class' => 'o-icon-delete',
            'title' => $translate('Remove item set'),
        ]) . '</li>
    </ul><input type="hidden" class="item-set-id" name="o:item_set[]"></td>
</tr>';
?>
<table id="item-item-sets" 
  data-tablesaw-mode="stack"
  data-item-sets="<?php echo $this->escapeHtml(json_encode($itemSets)); ?>"
  data-row-template="<?php echo $this->escapeHtml($itemSetTemplate); ?>"
  class="tablesaw tablesaw-stack">
    <thead>
    <tr>
        <th><?php echo $translate('Title'); ?></th>
        <th><?php echo $translate('Owner'); ?></th>
        <th></th>
    </tr>
    </thead>
    <tbody id="item-set-rows"></tbody>
</table>

<div class="no-resources">
    <p><?php echo $translate('This item is part of no item sets. Add it to an item set using the interface to the right.'); ?></p>
</div>

<button id="item-set-selector-button" class="mobile-only"><?php echo $translate('Add to item set'); ?></button>

<span id="item-set-template" data-template="<?php echo $escape($itemSetTemplate); ?>"></span>

<?php echo $this->itemSetSelector(); ?>
