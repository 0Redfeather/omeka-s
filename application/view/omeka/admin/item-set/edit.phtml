<?php
$this->htmlElement('body')->appendAttribute('class', 'edit item-set sidebar-open');
$escape = $this->plugin('escapeHtml');
$escapeAttr = $this->plugin('escapeHtmlAttr');
$this->headScript()->appendFile($this->assetUrl('js/resource-form.js', 'Omeka'));
$form->prepare();
$formLabel = $this->plugin('formLabel');
$formElement = $this->plugin('formElement');
$deleteButton = '<a href="#" class="delete button sidebar-confirm" 
    data-sidebar-confirm-url="' . $escapeAttr($itemSet->url('delete')) . 
    '">' . $escape('Delete') . '</a>';
?>

<script type='text/javascript'>
var valuesJson = <?php echo json_encode($itemSet->values()); ?>;
</script>

<h1><?php echo $this->translate('Edit Item Set'); ?>: &ldquo;<?php echo $escape($itemSet->displayTitle()); ?>&rdquo;</h1>

<form method='post' id='edit-item-set'>

    <nav class="section-nav">
        <ul>
            <li class="active"><a href="#resource-values">Values</a></li>
        </ul>
    </nav>
    <?php 
        //produces a <fieldset> with the id and class atts passed in.
        //on, e.g., the item add/edit pages, the id will work with the classes on 
        //the nav lis above. (see globals.js)  
        echo $this->partial(
                'common/resource-fields.phtml',
                array(
                    'id' => 'resource-values',
                    'class' => 'section active',
                    'form' => $form,
                    'resource' => $itemSet
                ));
    ?>

    <fieldset id="page-actions">
        <div class="o-icon-view visibility">
            <label for="o:is_public"><?php echo $escape('Public'); ?></label>
            <input type="checkbox" id="o:is_public" name="o:is_public" <?php echo ($itemSet->isPublic()) ? 'checked' : ''; ?>>
        </div>
        
        <?php echo (isset($deleteButton)) ? $deleteButton : ''; ?>
        <input type="submit" name="add-item-submit" value="Save" />
    </fieldset>
    <?php echo $this->formElement($form->get('csrf')); ?>
</form>


<?php 
        echo $this->partial('common/resource-form-templates.phtml');
?>

<div class="sidebar">
    <a href="#"
        class="sidebar-close o-icon-close"
        aria-label="<?php echo $escapeAttr($this->translate('Close')); ?>"
        title="<?php echo $escapeAttr($this->translate('Close')); ?>"></a>
    <div id="sidebar-confirm">
        <h2><?php echo $escape($this->translate('Delete Item Set')); ?></h2>
        <p><?php echo $escape($this->translate('Are you sure you would like to delete this item set?')); ?></p>
        <?php echo $this->form($confirmForm); ?>
    </div>
</div>
